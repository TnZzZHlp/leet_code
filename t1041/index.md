---
date: 2025-05-25
title: "1041. 困于环中的机器人"
categories: ["LeetCode"]
---

在无限的平面上，机器人最初位于 (0, 0) 处，面朝北方。注意:

北方向 是y轴的正方向。
南方向 是y轴的负方向。
东方向 是x轴的正方向。
西方向 是x轴的负方向。
机器人可以接受下列三条指令之一：

"G"：直走 1 个单位
"L"：左转 90 度
"R"：右转 90 度
机器人按顺序执行指令 instructions，并一直重复它们。

只有在平面中存在环使得机器人永远无法离开时，返回 true。否则，返回 false。

示例 1：
输入：instructions = "GGLLGG"
输出：true
解释：机器人最初在(0,0)处，面向北方。
“G”:移动一步。位置:(0,1)方向:北。
“G”:移动一步。位置:(0,2).方向:北。
“L”:逆时针旋转90度。位置:(0,2).方向:西。
“L”:逆时针旋转90度。位置:(0,2)方向:南。
“G”:移动一步。位置:(0,1)方向:南。
“G”:移动一步。位置:(0,0)方向:南。
重复指令，机器人进入循环:(0,0)——>(0,1)——>(0,2)——>(0,1)——>(0,0)。
在此基础上，我们返回true。

示例 2：
输入：instructions = "GG"
输出：false
解释：机器人最初在(0,0)处，面向北方。
“G”:移动一步。位置:(0,1)方向:北。
“G”:移动一步。位置:(0,2).方向:北。
重复这些指示，继续朝北前进，不会进入循环。
在此基础上，返回false。

示例 3：
输入：instructions = "GL"
输出：true
解释：机器人最初在(0,0)处，面向北方。
“G”:移动一步。位置:(0,1)方向:北。
“L”:逆时针旋转90度。位置:(0,1).方向:西。
“G”:移动一步。位置:(- 1,1)方向:西。
“L”:逆时针旋转90度。位置:(- 1,1)方向:南。
“G”:移动一步。位置:(- 1,0)方向:南。
“L”:逆时针旋转90度。位置:(- 1,0)方向:东方。
“G”:移动一步。位置:(0,0)方向:东方。
“L”:逆时针旋转90度。位置:(0,0)方向:北。
重复指令，机器人进入循环:(0,0)——>(0,1)——>(- 1,1)——>(- 1,0)——>(0,0)。
在此基础上，我们返回true。

提示：
1 <= instructions.length <= 100
instructions[i] 仅包含 'G', 'L', 'R'

### 反思

其实可以理解为每一次指令序列机器人都向某个方向移动了某个距离？

如果第一次执行后朝向**南**，则下一次执行时方向为朝向**北**，并且两次位移刚好抵消，所以可以回到原点并且成环

如果第一次执行后朝向**东/西**，则下一次执行时方向为朝向**南**，再执行两次的话方向刚刚好回到了向**北**，然后四次位移刚好抵消，所以可以成环

---

让我用更直观的方式解释，关键在于理解**为什么执行4次就够了**：

## 核心概念：方向的周期性

机器人只有4个方向，所以**方向的变化是周期性的**：

```plaintext
北(0) → 东(1) → 南(2) → 西(3) → 北(0) → ...
```

## 关键洞察

执行一次指令后，机器人会：

1. 移动到新位置 `(dx, dy)`
2. 转向新方向

**重点**：如果机器人要成环，必须在某个时刻回到原点且朝向北方。

## 为什么最多4次？

让我们追踪方向变化：

```rust
// 假设执行1次指令后，方向从北(0)变成了east(1)
初始：北(0)
1次后：东(1) 
2次后：南(2)  
3次后：西(3)
4次后：北(0) ← 方向回到初始状态！
```

## 数学原理

如果执行1次指令后：

- 位移：`(dx, dy)`  
- 方向：从北转到东（顺时针90°）

那么4次执行的总位移是：

```plaintext
第1次：(dx, dy)           // 朝东移动
第2次：(-dy, dx)          // 把第1次的移动旋转90°
第3次：(-dx, -dy)         // 把第1次的移动旋转180°  
第4次：(dy, -dx)          // 把第1次的移动旋转270°

总和：(dx-dy-dx+dy, dy+dx-dy-dx) = (0, 0)
```

## 简单例子验证

指令 `"GR"`（前进1步，右转90°）：

```plaintext
初始：(0,0) 朝北
1次：(0,1) 朝东    // 前进到(0,1)，右转朝东
2次：(1,1) 朝南    // 前进到(1,1)，右转朝南 
3次：(1,0) 朝西    // 前进到(1,0)，右转朝西
4次：(0,0) 朝北    // 前进到(0,0)，右转朝北 → 成环！
```

## 总结

- **如果1次后朝向没变（还是北）**：要么立即成环，要么永远不成环
- **如果1次后朝向变了**：最多4次后方向必定回到北，此时要么在原点（成环），要么不在（永远不成环）

这就是为什么4次是充分的判断条件！## 总结

- **如果1次后朝向没变（还是北）**：要么立即成环，要么永远不成环
- **如果1次后朝向变了**：最多4次后方向必定回到北，此时要么在原点（成环），要么不在（永远不成环）

这就是为什么4次是充分的判断条件！
